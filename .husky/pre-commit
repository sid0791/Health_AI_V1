#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit hooks..."

# Run lint-staged for staged files but continue on errors
echo "ğŸ“ Running lint-staged..."
npx lint-staged || {
  echo "âš ï¸  Lint-staged found issues but continuing..."
}

# Check for secrets in staged files
echo "ğŸ” Scanning for secrets..."
if command -v gitleaks &> /dev/null; then
  gitleaks protect --staged --verbose || {
    echo "âš ï¸  Gitleaks found issues but continuing..."
  }
else
  echo "âš ï¸  Warning: gitleaks not found. Skipping secret scan."
  echo "ğŸ’¡ Install gitleaks: https://github.com/zricethezav/gitleaks#installation"
fi

# Note: Commit message validation happens in commit-msg hook, not pre-commit
echo "ğŸ“ Pre-commit checks ready for commit message validation..."

echo "âœ… Pre-commit checks completed!"